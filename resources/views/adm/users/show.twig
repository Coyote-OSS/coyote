{% extends 'adm.base' %}
{% block title %}Użytkownicy :: {{ user.name }} :: {{ parent() }}{% endblock %}

{% block container %}
  {{ activity.chartLibrarySource }}

  <div class="card">
    <div class="card-header">
      Użytkownik {{ navigation.mention }}
    </div>

    <ul class="list-group list-group-flush">
      <li class="list-group-item d-flex justify-content-between">
        <span><b>Utworzenie konta</b>: {{ userDetails.accountCreated.ago }}</span>
        <span class="text-muted">{{ userDetails.accountCreated.format }}</span>
      </li>
      <li class="list-group-item d-flex justify-content-between">
        <span><b>Ostatnie logowanie</b>: {{ userDetails.lastVisit.ago }}</span>
        <span class="text-muted">{{ userDetails.lastVisit.format }}</span>
      </li>
      <li class="list-group-item">
        <a class="btn btn-secondary" href="{{ navigation.profile }}">
          {{ icon('adminUserShowProfile') }}
          Pokaż profil
        </a>
        <a class="btn btn-secondary" href="{{ navigation.settings }}">
          {{ icon('adminUserAccountSettings') }}
          Ustawienia konta
        </a>
        <a class="btn btn-secondary" href="{{ navigation.stream }}">
          {{ icon('adminUserFindInLog') }}
          Znajdź w dzienniku zdarzeń
        </a>
        <a class="btn btn-secondary" href="{{ navigation.inspect }}">
          {{ icon('adminUserFindFingerprints') }}
          Znajdź fingerprinty
        </a>
      </li>

      <li class="list-group-item">
        <p class="mb-2">Znajd treści użytkownika:</p>
        <a class="btn btn-secondary" href="{{ navigation.posts }}">
          {{ icon('adminUserPosts') }}
          Napisane posty
        </a>
        <a class="btn btn-secondary" href="{{ navigation.microblogs }}">
          {{ icon('adminUserMicroblogs') }}
          Napisane mikroblogi
        </a>
        <a class="btn btn-secondary" href="{{ navigation.comments }}">
          {{ icon('adminUserPostComments') }}
          Napisane komentarze
        </a>
        <a class="btn btn-secondary" href="{{ navigation.receivedFlags }}">
          {{ icon('adminUserReportReceived') }}
          Otrzymane raporty
        </a>
      </li>
    </ul>
  </div>
  <div class="card">
    <div class="card-header">
      {{ icon('adminUserSettings') }}
      Treści dodane przez użytkownika {{ navigation.mention }}
    </div>
    <ul class="list-group list-group-flush">
      <li class="list-group-item">
        Rozpoczętych wątków: <b>{{ userContent.topics }}</b>
      </li>
      <li class="list-group-item d-flex justify-content-between">
        <span>
          Napisanych postów: <b>{{ userContent.posts }}</b> / <b>{{ userContent.postsDeleted }}</b>
        </span>
        <span class="text-muted">W tym posty rozpoczynające wątki.</span>
      </li>
      <li class="list-group-item">
        Napisanych komentarzy pod postami: <b>{{ userContent.postComments }}</b> / <b>{{ userContent.postCommentsDeleted }}</b>
      </li>
      <li class="list-group-item">
        Napisanych mikroblogów: <b>{{ userContent.blogs }}</b> / <b>{{ userContent.blogsDeleted }}</b>
      </li>
      <li class="list-group-item">
        Napisanych komentarzy pod mikroblogami: <b>{{ userContent.blogComments }}</b> / <b>{{ userContent.blogCommentsDeleted }}</b>
      </li>
      <li class="list-group-item">
        Oddanych głosow na posty: <b>{{ userContent.postVotes }}</b>
      </li>
      <li class="list-group-item">
        Oddanych głosow na mikroblogi: <b>{{ userContent.microblogVotes }}</b>
      </li>
      <li class="list-group-item">
        Dodanych raportów: <b>{{ userContent.flags }}</b> / <b>{{ userContent.flagsTotal }}</b>
      </li>
      <li class="list-group-item">
        Wysłanych wiadomości: <b>{{ userContent.privateMessages }}</b>
      </li>
      <li class="list-group-item">
        Utworzonych ofert pracy: <b>{{ userContent.jobOffers }}</b>
      </li>
      <li class="list-group-item">
        Zdobyta reputacja: <b>{{ userContent.reputation }}</b>
      </li>
      <li class="list-group-item">
        {% if userContentAction.canDelete %}
          <form action="{{ userContentAction.url }}" method="POST" class="d-flex flex-wrap gap-2">
            <input type="hidden" name="_token" value="{{ csrf_token() }}">
            <button class="btn btn-secondary" type="submit" name="contentDelete" value="deletePosts">Usuń posty</button>
            <button class="btn btn-secondary" type="submit" name="contentDelete" value="deletePostComments">Usuń komentarze</button>
            <button class="btn btn-secondary" type="submit" name="contentDelete" value="deleteBlogs">Usuń mikroblogi</button>
            <button class="btn btn-secondary" type="submit" name="contentDelete" value="deleteBlogComments">Usuń komentarze
              mikroblogów</button>
            <button class="btn btn-secondary" type="submit" name="contentDelete" value="deletePostVotes">Usuń głosy na posty</button>
            <button class="btn btn-secondary" type="submit" name="contentDelete" value="deleteBlogVotes">Usuń głosy na mikroblogi</button>
            <button class="btn btn-secondary" type="submit" name="contentDelete" value="deleteFlags">Usuń raporty</button>
            <button class="btn btn-secondary" type="submit" name="contentDelete" value="deleteJobOffers">Usuń oferty pracy</button>
          </form>
        {% else %}
          <div class="text-center">
            <span class="text-muted">Konto jest chronione przed masowym usunięciem treści.</span>
          </div>
        {% endif %}
      </li>
    </ul>
  </div>

  <div class="card">
    <div class="card-header">
      {{ icon('adminUserStatistics') }}
      Aktywność w kategoriach użytkownika {{ navigation.mention }}
    </div>
    <div class="card-body">
      <div class="btn-group mb-4">
        <a href="?" class="btn btn-secondary">
          {{ icon('adminUserStatisticsAllTime') }}
          Wszystko
        </a>
        <a href="?last=year" type="button" class="btn btn-secondary">
          {{ icon('adminUserStatisticsLastYear') }}
          Ostatnie 365 dni
        </a>
        <a href="?last=month" type="button" class="btn btn-secondary">
          {{ icon('adminUserStatisticsLastMonth') }}
          Ostatnie 31 dni
        </a>
        <a href="?last=week" type="button" class="btn btn-secondary">
          {{ icon('adminUserStatisticsLastWeek') }}
          Ostatnie 7 dni
        </a>
        <a href="?last=day" type="button" class="btn btn-secondary">
          {{ icon('adminUserStatisticsLastDay') }}
          Ostatnie 24h
        </a>
      </div>

      <div class="d-lg-flex">
        <div class="col-lg-6 px-0">
          <div class="card">
            <div class="card-header">
              Posty dodawane w kategoriach ({{ activity.postsStatistic.all }})
            </div>
            <div class="card-body">
              {% if not activity.categoriesChart.empty %}
                {{ activity.categoriesChart }}
              {% else %}
                Użytkownik nie napisał żadnego postu w zadanym zakresie.
              {% endif %}
            </div>
          </div>
          <div class="card">
            <div class="card-header">
              Głosy otrzymane w kategoriach
            </div>
            <div class="card-body">
              {% if not activity.categoriesChartLikes.empty %}
                {{ activity.categoriesChartLikes }}
              {% else %}
                Użytkownik nie otrzymał żadnego głosu w zadanym zakresie.
              {% endif %}
            </div>
          </div>
        </div>
        <div class="col-lg-6 px-0 ps-lg-3">
          <div class="card">
            <div class="card-header">
              Usunięte posty
            </div>
            <ul class="list-group list-group-flush">
              <li class="list-group-item">
                Postów usuniętych przez siebie:
                <b> {{ activity.postsStatistic.deletedBySelf }}</b>
                <span class="text-muted">
                  {{ activity.postsStatistic.deletedBySelfProportion }}
                </span>
              </li>
              <li class="list-group-item">
                Postów usuniętych przez moderatora:
                <b>{{ activity.postsStatistic.deletedByModerator }}</b>
                <span class="text-muted">
                  {{ activity.postsStatistic.deletedByModeratorProportion }}
                </span>
                {% if not activity.deleteReasonsChart.empty %}
                  <div class="mt-3">
                    {{ activity.deleteReasonsChart }}
                  </div>
                {% endif %}
              </li>
            </ul>
          </div>
          <div class="card">
            <div class="card-header">
              Powody zgłoszeń na posty użytkownika
            </div>
            <div class="card-body">
              {% if not activity.reportReasonsChart.empty %}
                <div class="mt-3">
                  {{ activity.reportReasonsChart }}
                </div>
              {% else %}
                Użytkownik nie otrzymał zgłoszeń w zadanym zakresie.
              {% endif %}
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <a class="btn btn-secondary" href="{{ navigation.users }}">
    Powrót
  </a>
{% endblock %}
